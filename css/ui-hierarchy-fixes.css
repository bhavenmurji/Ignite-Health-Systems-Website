/**
 * Ignite Health Systems - UI Hierarchy Fixes
 * Resolves z-index conflicts and container overflow issues
 */

/* Z-Index Hierarchy - Strict ordering to prevent conflicts */
:root {
    --z-base: 1;
    --z-dropdown: 100;
    --z-sticky: 200;
    --z-fixed: 300;
    --z-modal-backdrop: 998;
    --z-mobile-menu: 999;
    --z-navbar: 1000;
    --z-mobile-toggle: 1001;
    --z-intro-overlay: 10000;
    --z-intro-content: 10001;
}

/* Reset conflicting z-index values */
.navbar {
    z-index: var(--z-navbar) !important;
}

.intro-overlay {
    z-index: var(--z-intro-overlay) !important;
}

.intro-content {
    z-index: var(--z-intro-content) !important;
}

.mobile-menu-toggle {
    z-index: var(--z-mobile-toggle) !important;
}

.mobile-nav-menu {
    z-index: var(--z-mobile-menu) !important;
}

.mobile-nav-overlay {
    z-index: var(--z-modal-backdrop) !important;
}

/* Container overflow fixes for mobile */
.container {
    max-width: 100%;
    padding-left: clamp(1rem, 4vw, 1.5rem);
    padding-right: clamp(1rem, 4vw, 1.5rem);
    overflow-x: hidden;
}

/* Mobile-specific container fixes */
@media (max-width: 768px) {
    .container,
    .nav-container,
    .hero-container,
    .footer-container {
        padding-left: 1rem;
        padding-right: 1rem;
        max-width: 100%;
        overflow-x: hidden;
    }
    
    /* Prevent horizontal scroll on mobile */
    body {
        overflow-x: hidden;
        width: 100%;
        position: relative;
    }
    
    html {
        overflow-x: hidden;
        width: 100%;
    }
    
    /* Fix mobile menu stacking context */
    .nav-menu {
        z-index: var(--z-mobile-menu) !important;
        transform: translateX(-100%) translateZ(0);
        transition: transform 0.3s ease-in-out;
    }
    
    .nav-menu.active {
        transform: translateX(0) translateZ(0);
    }
    
    /* Ensure content doesn't clip */
    .hero,
    .problem-statement,
    .solution,
    .platform-features,
    .social-proof,
    .final-cta {
        overflow-x: hidden;
        width: 100%;
    }
    
    /* Fix text overflow in mobile */
    .hero-title,
    .section-header h2 {
        word-wrap: break-word;
        overflow-wrap: break-word;
        hyphens: auto;
    }
}

/* Hardware acceleration for smoother animations */
.intro-overlay,
.intro-content,
.intro-logo,
.intro-title .word,
.mobile-menu-toggle,
.nav-menu {
    transform: translateZ(0);
    will-change: transform, opacity;
    backface-visibility: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Prevent layout shift during intro animation */
.intro-overlay.fade-out {
    pointer-events: none;
    transform: translateZ(0);
}

.intro-overlay.hidden {
    display: none !important;
    visibility: hidden;
    opacity: 0;
}

/* Mobile menu interaction improvements */
@media (max-width: 768px) {
    /* Touch-friendly mobile menu toggle */
    .mobile-menu-toggle {
        padding: 0.5rem;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }
    
    /* Improved mobile menu slide animation */
    .nav-menu {
        -webkit-transform: translateX(-100%) translateZ(0);
        -moz-transform: translateX(-100%) translateZ(0);
        -ms-transform: translateX(-100%) translateZ(0);
        transform: translateX(-100%) translateZ(0);
        -webkit-transition: -webkit-transform 0.3s ease-in-out;
        -moz-transition: -moz-transform 0.3s ease-in-out;
        -ms-transition: -ms-transform 0.3s ease-in-out;
        transition: transform 0.3s ease-in-out;
    }
    
    .nav-menu.active {
        -webkit-transform: translateX(0) translateZ(0);
        -moz-transform: translateX(0) translateZ(0);
        -ms-transform: translateX(0) translateZ(0);
        transform: translateX(0) translateZ(0);
    }
}

/* Performance optimizations */
.intro-overlay,
.nav-menu,
.mobile-nav-menu {
    contain: layout style paint;
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .intro-overlay,
    .intro-content,
    .intro-logo,
    .intro-title .word,
    .nav-menu,
    .mobile-menu-toggle span {
        animation: none !important;
        transition: opacity 0.3s ease !important;
    }
    
    .intro-title .word {
        opacity: 1 !important;
        transform: none !important;
    }
}

/* Focus improvements for accessibility */
.mobile-menu-toggle:focus {
    outline: 2px solid var(--primary, #ff6b35);
    outline-offset: 2px;
}

.nav-link:focus {
    outline: 2px solid var(--primary, #ff6b35);
    outline-offset: 2px;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    .mobile-menu-toggle span {
        background: white;
    }
    
    .intro-overlay {
        background: black !important;
    }
    
    .nav-menu {
        background: black;
        border: 1px solid white;
    }
}

/* Ensure proper layering on all screen sizes */
@media (min-width: 769px) {
    .mobile-menu-toggle,
    .mobile-nav-menu,
    .mobile-nav-overlay {
        display: none !important;
    }
}

/* Critical layout fixes */
* {
    box-sizing: border-box;
}

*::before,
*::after {
    box-sizing: border-box;
}

/* Prevent text overflow and layout breaks */
.hero-title,
.intro-title,
.section-header h2 {
    max-width: 100%;
    word-break: break-word;
    overflow-wrap: break-word;
}

/* Ensure elements don't extend beyond viewport */
.hero,
.navbar,
.footer,
.section {
    max-width: 100vw;
    overflow-x: hidden;
}